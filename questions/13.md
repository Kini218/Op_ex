# Основные отношения между классами: композиция. Программная реализация, примеры композиционной структуры.

### **Композиция в программировании**

**Композиция** — это тип ассоциации, при котором один объект "состоит из" других объектов, и эти составные объекты управляются и существуют исключительно в контексте "владельца". Если объект-владелец уничтожается, то уничтожаются и все его компоненты.

---

### **1. Характеристики композиции**

- **Сильная зависимость:** Жизненный цикл компонентов зависит от владельца.
- **"Часть-целое":** Композиция описывает отношение, где один объект является частью другого.
- **Управление жизненным циклом:** Владелец отвечает за создание и уничтожение составляющих объектов.

---

### **2. Программная реализация композиции**

Композиция реализуется с использованием полей, свойств или методов, в которых создаются экземпляры зависимых объектов внутри класса.

#### **Пример: Класс "Автомобиль" с композицией**
```csharp
public class Engine
{
    public void Start() => Console.WriteLine("Engine started.");
}

public class Car
{
    private Engine engine;

    public Car()
    {
        engine = new Engine(); // Двигатель создаётся внутри автомобиля
    }

    public void StartCar()
    {
        Console.WriteLine("Car is starting...");
        engine.Start(); // Использование двигателя
    }
}

// Использование
Car car = new Car();
car.StartCar();
```

**Объяснение:**
- `Engine` существует только в контексте `Car`.
- Когда `Car` уничтожается, уничтожается и `Engine`.

---

### **3. Примеры композиционной структуры**

#### **3.1. Композиция: "Дом состоит из комнат"**
```csharp
public class Room
{
    public string Name { get; set; }

    public Room(string name)
    {
        Name = name;
    }
}

public class House
{
    private List<Room> rooms = new List<Room>();

    public House()
    {
        rooms.Add(new Room("Living Room"));
        rooms.Add(new Room("Bedroom"));
        rooms.Add(new Room("Kitchen"));
    }

    public void ShowRooms()
    {
        Console.WriteLine("Rooms in the house:");
        foreach (var room in rooms)
        {
            Console.WriteLine($"- {room.Name}");
        }
    }
}

// Использование
House house = new House();
house.ShowRooms();
```

**Объяснение:**
- `Room` не существует без `House`.
- Комнаты создаются внутри конструктора `House`.

---

#### **3.2. Композиция: "Компьютер состоит из компонентов"**
```csharp
public class Processor
{
    public void Execute() => Console.WriteLine("Processor is executing instructions.");
}

public class Memory
{
    public void LoadData() => Console.WriteLine("Memory is loading data.");
}

public class Computer
{
    private Processor processor;
    private Memory memory;

    public Computer()
    {
        processor = new Processor();
        memory = new Memory();
    }

    public void Start()
    {
        Console.WriteLine("Computer is starting...");
        processor.Execute();
        memory.LoadData();
    }
}

// Использование
Computer computer = new Computer();
computer.Start();
```

---

### **4. Отличия композиции от других отношений**

| **Отношение**   | **Описание**                                                                                  | **Пример**                                      |
|------------------|----------------------------------------------------------------------------------------------|------------------------------------------------|
| **Ассоциация**  | Связь между объектами, которые могут существовать независимо друг от друга.                  | Книга связана с автором.                      |
| **Агрегация**   | Слабая зависимость: "части" могут существовать независимо от "целого".                       | Университет содержит факультеты.              |
| **Композиция**  | Сильная зависимость: "части" существуют только в контексте "целого".                         | Автомобиль состоит из двигателя и колёс.       |

---

### **5. Реальные примеры композиции**

1. **Дом и комнаты:** Дом управляет созданием и уничтожением своих комнат.
2. **Автомобиль и его детали:** Колёса, двигатель и кузов автомобиля составляют одно целое.
3. **Компьютер и его компоненты:** Процессор, оперативная память и материнская плата.

---

### **6. Преимущества композиции**

- **Гибкость:** Позволяет разбить систему на более мелкие, повторно используемые компоненты.
- **Управление жизненным циклом:** Упрощает управление составными частями объекта.
- **Повторное использование:** Компоненты могут быть использованы в других системах.

---

### **7. Итог**

Композиция — это мощный инструмент объектно-ориентированного проектирования, позволяющий создавать сложные объекты, состоящие из других объектов. Она используется для выражения отношений "часть-целое" и обеспечивает строгую зависимость между компонентами и объектом-владельцем.